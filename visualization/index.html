<html>

<head>
  <meta charset="utf-8">
  <title>HonestNFT Data Visualization</title>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@0.21.1/dist/axios.min.js"></script>
  <script src="https://unpkg.com/vue-lazyload/vue-lazyload.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ant-design-vue@1.7.2/dist/antd.min.css">
  <script src="https://cdn.jsdelivr.net/npm/ant-design-vue@1.7.2/dist/antd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>

  <!-- Resources -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/v-charts/lib/index.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-charts/lib/style.min.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-apexcharts@1.6.2/dist/vue-apexcharts.min.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <style>
      body {
       font-family: 'courier new',courier-ps-w01,courier-ps-w02,courier-ps-w10,monospace
      }

      h2 {
          font-size: 1.8rem;
      }
  </style>
</head>
<body>
  <div id="app">
    <a-layout id="components-layout-demo-top-side">
      <a-layout-header class="header" style="background: black;">
        <router-link to="/">
            <div style="color: white; text-align: center; font-size: 30px;">HonestNFT</div>
        </router-link>
      </a-layout-header>
      <a-layout-content style="padding: 0 50px">
        <a-layout style="padding: 0px 0; width: 1300px; margin: 30px auto; background: #fff">
          <a-layout-content :style="{ padding: '40px 40px', minHeight: '680px' }">
            <a-spin :spinning="loading" />
            <div class="block-item" v-if="!isDetail">
              <h2>Collections</h2>
              <a-row :gutter="25">
                <a-col>
                  <a-table :columns="taskTable.columns" :data-source="taskTable.data" :pagination="false" bordered/>
                </a-col>
              </a-row>
            </div>
            <div class="block-item" v-if="isDetail">
                <div style="border-bottom: 1px solid #eee; margin-bottom: 30px">
                    <h2 style="margin-bottom: 20px;">
                        <img :src="currentCollection.logo" height="100" style="margin-right: 10px"> {{ currentCollection.name }}
                    <h2>
                </div>

                <h2>Raraity Map</h2>

                <apexchart type="scatter" height="350" :options="chartOptions" :series="series"></apexchart>
                <!-- <a-row :gutter="25">
                    <a-col>
                        <a-table :columns="taskTable.columns" :data-source="taskTable.data" :pagination="false" bordered />
                    </a-col>
                </a-row> -->
            </div>
          </a-layout-content>
        </a-layout>
      </a-layout-content>
      <a-layout-footer style="text-align: center">
        Made By <a href="https://twitter.com/lljxx1">fun</a>
      </a-layout-footer>
    </a-layout>

  </div>
  <script>
    Vue.use(VueRouter);

    const routes = [
        { path: '/' },
        { path: '/collection/:slug', name: 'Detail'}
    ]

    const router = new VueRouter({
        routes: routes 
    })

    var app = new Vue({
        router,
      el: '#app',
       components: {
            apexchart: VueApexCharts,
        },
      data: {
        loading: true,
        collections: [],

        series: [{
              name: "SAMPLE A",
              data: [
                  [16.4, 5.4], [21.7, 2], [25.4, 3], [19, 2], [10.9, 1], [13.6, 3.2], [10.9, 7.4], [10.9, 0], [10.9, 8.2], [16.4, 0], [16.4, 1.8], [13.6, 0.3], [13.6, 0], [29.9, 0], [27.1, 2.3], [16.4, 0], [13.6, 3.7], [10.9, 5.2], [16.4, 6.5], [10.9, 0], [24.5, 7.1], [10.9, 0], [8.1, 4.7], [19, 0], [21.7, 1.8], [27.1, 0], [24.5, 0], [27.1, 0], [29.9, 1.5], [27.1, 0.8], [22.1, 2]]
          }, {
              name: "SAMPLE B",
              data: [
                  [36.4, 13.4], [1.7, 11], [5.4, 8], [9, 17], [1.9, 4], [3.6, 12.2], [1.9, 14.4], [1.9, 9], [1.9, 13.2], [1.4, 7], [6.4, 8.8], [3.6, 4.3], [1.6, 10], [9.9, 2], [7.1, 15], [1.4, 0], [3.6, 13.7], [1.9, 15.2], [6.4, 16.5], [0.9, 10], [4.5, 17.1], [10.9, 10], [0.1, 14.7], [9, 10], [12.7, 11.8], [2.1, 10], [2.5, 10], [27.1, 10], [2.9, 11.5], [7.1, 10.8], [2.1, 12]]
          }, {
              name: "SAMPLE C",
              data: [
                  [21.7, 3], [23.6, 3.5], [24.6, 3], [29.9, 3], [21.7, 20], [23, 2], [10.9, 3], [28, 4], [27.1, 0.3], [16.4, 4], [13.6, 0], [19, 5], [22.4, 3], [24.5, 3], [32.6, 3], [27.1, 4], [29.6, 6], [31.6, 8], [21.6, 5], [20.9, 4], [22.4, 0], [32.6, 10.3], [29.7, 20.8], [24.5, 0.8], [21.4, 0], [21.7, 6.9], [28.6, 7.7], [15.4, 0], [18.1, 0], [33.4, 0], [16.4, 0]]
          }],
          chartOptions: {
              chart: {
                  height: 350,
                  type: 'scatter',
                  zoom: {
                      enabled: true,
                      type: 'xy'
                  }
              },
              xaxis: {
                  tickAmount: 10,
                  labels: {
                      formatter: function (val) {
                          return parseFloat(val).toFixed(1)
                      }
                  }
              },
              yaxis: {
                  tickAmount: 7
              }
          },
      },
      
      computed: {
          currentCollection() {
              if (!this.isDetail) {
                return null
              }

              return this.collections.find(_ => _.slug == this.$route.params.slug)
          },
          isDetail() {
            return this.$route.name == 'Detail'
          },
        taskTable() {
            const h = this.$createElement
          return {
            columns: [
              {
                title: 'Name',
                dataIndex: 'logo',
                with: '400',
                customRender: (text, row, index) => {
                    return h('div',  {
                            attrs: {
                                // style: "max-width: 300px"
                        }
                    },
                    [
                        h('a', {
                            attrs: {
                                href: `#/collection/${row.slug}`
                            }
                        },
                        
                        [
                            h('img', {
                                attrs: {
                                    src: text,
                                    width: 100,
                                    style: "margin-right: 10px"
                                }
                            }),
                            h('span', {
                                attrs: {
                                    style: "font-weight: bold"
                                }
                            },
                                [row.name])
                        ])
                    ]
                    )
                },
              },
              {
                title: 'totalSupply',
                dataIndex: 'totalSupply',
              },
              {
                title: 'totalVolume',
                dataIndex: 'totalVolume',
              },
            {
                title: 'Detail',
                customRender: (text, row, index) => {
                    return h('div', {
                              attrs: {
                                  // style: "max-width: 300px"
                              }
                          },
                        [
                            h('a', {
                                attrs: {
                                    href: row.opensea,
                                    target: "_blank",
                                    style: "margin-right: 10px"
                                }
                            }, 
                            [
                                'Opensea'
                            ]),
                        ])
                  },
                }
            ],
            data: this.collections
          }
        },
     },
     watch: {
        $route() {
            this.loadCollection()
        }
     },
      mounted() {
        console.log(this.$router)
        this.loadData();
        if (this.isDetail) {
            this.loadCollection()
        }
      },
      methods: {
          async loadCollection() {
            const slug = this.$route.params.slug
            const { data } = await axios.get('https://honestnftapi.mywallet.tools/api/getCollection', {
                params: {
                    slug
                }
            })
            console.log('loadCollection', slug, data)
          },
        async loadData() {
          const { data } = await axios.get('https://honestnftapi.mywallet.tools/api/getAllCollection')
          this.collections = data.collections
          this.loading = false;
          console.log(this.collections)
        }
      },
    })


  </script>
</body>

</html>